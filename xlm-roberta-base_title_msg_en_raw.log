2022-11-20 15:57:32,895 | INFO: Script args:
{'txt_field': 'title', 'splits': ['train', 'val', 'test'], 'dataset': 'msg_en', 'model_checkpoint': 'xlm-roberta-base', 'num_epochs': 50, 'batch_size': 256}
2022-11-20 15:57:32,896 | INFO: Loading dataset
2022-11-20 15:57:33,440 | WARNING: Using custom data configuration default-b5b3d374d17854c7
2022-11-20 15:57:33,469 | WARNING: Found cached dataset parquet (/cluster/home/erlenoi/.cache/huggingface/datasets/parquet/default-b5b3d374d17854c7/0.0.0/2a3b91fbd88a2c90d1dbbb32b460cf621d31bd5b05b934492fdef7d8d6f236ec)
2022-11-20 15:57:33,697 | INFO: Loading tokenizer
2022-11-20 15:57:38,774 | INFO: Tokenizing dataset on title
2022-11-20 15:57:38,776 | WARNING: Loading cached processed dataset at /cluster/home/erlenoi/.cache/huggingface/datasets/parquet/default-b5b3d374d17854c7/0.0.0/2a3b91fbd88a2c90d1dbbb32b460cf621d31bd5b05b934492fdef7d8d6f236ec/cache-2de5e1b0cd9f7816.arrow
2022-11-20 15:57:38,781 | WARNING: Loading cached processed dataset at /cluster/home/erlenoi/.cache/huggingface/datasets/parquet/default-b5b3d374d17854c7/0.0.0/2a3b91fbd88a2c90d1dbbb32b460cf621d31bd5b05b934492fdef7d8d6f236ec/cache-4e0459c35ea81a41.arrow
2022-11-20 15:57:38,786 | WARNING: Loading cached processed dataset at /cluster/home/erlenoi/.cache/huggingface/datasets/parquet/default-b5b3d374d17854c7/0.0.0/2a3b91fbd88a2c90d1dbbb32b460cf621d31bd5b05b934492fdef7d8d6f236ec/cache-12ead5fb0644f22d.arrow
2022-11-20 15:57:38,838 | WARNING: Loading cached processed dataset at /cluster/home/erlenoi/.cache/huggingface/datasets/parquet/default-b5b3d374d17854c7/0.0.0/2a3b91fbd88a2c90d1dbbb32b460cf621d31bd5b05b934492fdef7d8d6f236ec/cache-31e69babd8a85a5f.arrow
2022-11-20 15:57:39,164 | WARNING: Loading cached processed dataset at /cluster/home/erlenoi/.cache/huggingface/datasets/parquet/default-b5b3d374d17854c7/0.0.0/2a3b91fbd88a2c90d1dbbb32b460cf621d31bd5b05b934492fdef7d8d6f236ec/cache-4ebc7f564e815902.arrow
2022-11-20 15:57:39,568 | WARNING: Loading cached processed dataset at /cluster/home/erlenoi/.cache/huggingface/datasets/parquet/default-b5b3d374d17854c7/0.0.0/2a3b91fbd88a2c90d1dbbb32b460cf621d31bd5b05b934492fdef7d8d6f236ec/cache-06b8f25259150fd7.arrow
2022-11-20 15:57:39,994 | INFO: Longest title in train (words): 40
2022-11-20 15:57:39,994 | INFO: Creating DataPaddingCollator
2022-11-20 15:57:39,994 | INFO: Loading autoconfig
2022-11-20 15:57:40,482 | INFO: Overriden AutoConfig:
XLMRobertaConfig {
  "_name_or_path": "xlm-roberta-base",
  "architectures": [
    "XLMRobertaForMaskedLM"
  ],
  "attention_probs_dropout_prob": 0.1,
  "bos_token_id": 0,
  "classifier_dropout": null,
  "eos_token_id": 2,
  "hidden_act": "gelu",
  "hidden_dropout_prob": 0.1,
  "hidden_size": 768,
  "id2label": {
    "0": "positive",
    "1": "neutral",
    "2": "negative"
  },
  "initializer_range": 0.02,
  "intermediate_size": 3072,
  "label2id": {
    "negative": 2,
    "neutral": 1,
    "positive": 0
  },
  "layer_norm_eps": 1e-05,
  "max_position_embeddings": 514,
  "model_type": "xlm-roberta",
  "num_attention_heads": 12,
  "num_hidden_layers": 12,
  "output_past": true,
  "pad_token_id": 1,
  "position_embedding_type": "absolute",
  "transformers_version": "4.18.0",
  "type_vocab_size": 1,
  "use_cache": true,
  "vocab_size": 250002
}

2022-11-20 15:57:40,483 | INFO: Loading model
2022-11-20 15:57:44,422 | INFO: Dividing and OHE labels
2022-11-20 15:57:49,558 | INFO: Post process features
2022-11-20 15:57:49,558 | INFO: {'labels': Value(dtype='int64', id=None), 'input_ids': Sequence(feature=Value(dtype='int32', id=None), length=-1, id=None), 'attention_mask': Sequence(feature=Value(dtype='int8', id=None), length=-1, id=None)}
2022-11-20 15:57:54,975 | INFO: Setup Trainer
2022-11-20 15:57:58,462 | INFO: STARTING TRAINING
2022-11-20 17:41:56,637 | INFO: Eval results on best model
2022-11-20 17:42:02,515 | INFO: {'eval_loss': 0.5762169361114502, 'eval_accuracy': 0.779448350459708, 'eval_precision': 0.6075397310343597, 'eval_recall': 0.779448350459708, 'eval_f1': 0.6828405341210451, 'eval_runtime': 5.8712, 'eval_samples_per_second': 1574.643, 'eval_steps_per_second': 12.434, 'epoch': 50.0}
2022-11-20 17:42:02,515 | INFO: Predicting on test
2022-11-20 17:42:14,212 | INFO: PredictionOutput(predictions=array([[ 0.24498062, -2.5556269 ,  1.6941414 ],
       [ 0.24498118, -2.5556235 ,  1.6941416 ],
       [ 0.24498104, -2.5556238 ,  1.6941417 ],
       ...,
       [ 0.24498148, -2.5556254 ,  1.6941423 ],
       [ 0.24498132, -2.5556276 ,  1.6941423 ],
       [ 0.24498148, -2.5556254 ,  1.6941423 ]], dtype=float32), label_ids=array([2, 2, 2, ..., 2, 0, 2]), metrics={'test_loss': 0.5796314477920532, 'test_accuracy': 0.7797068527232408, 'test_precision': 0.6079427761835816, 'test_recall': 0.7797068527232408, 'test_f1': 0.6831942859053785, 'test_runtime': 11.6956, 'test_samples_per_second': 1580.857, 'test_steps_per_second': 12.398})
2022-11-20 17:42:14,213 | INFO: COMPLETE
